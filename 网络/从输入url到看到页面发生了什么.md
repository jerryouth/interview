## URL的输入到浏览器解析的一系列事件

* DNS解析
* 发起TCP连接
* 发送HTTP请求
* 服务器处理请求并返回HTTP报文
* 浏览器解析渲染页面
* 连接结束。


### DNS解析

DNS存在着多级缓存，从离浏览器的距离排序的话，有以下几种: 
* 浏览器缓存，
* 系统缓存，
* 路由器缓存，
* IPS服务器缓存，
* 根域名服务器缓存，
* 顶级域名服务器缓存，
* 主域名服务器缓存。


在你的chrome浏览器中输入:chrome://dns/，你可以看到chrome浏览器的DNS缓存。


系统缓存主要存在/etc/hosts(Linux系统)中


### DNS负载均衡
不知道你们有没有注意这样一件事，你访问baidu.com的时候，每次响应的并非是同一个服务器（IP地址不同），一般大公司都有成百上千台服务器来支撑访问，假设只有一个服务器，那它的性能和存储量要多大才能支撑这样大量的访问呢？DNS可以返回一个合适的机器的IP给用户，例如可以根据每台机器的负载量，该机器离用户地理位置的距离等等，这种过程就是DNS负载均衡



### 发起TCP连接

#### 三次握手

##### 第一次握手

客户端发送syn包(Seq=x)到服务器，并进入SYN_SEND状态，等待服务器确认；

##### 第二次握手：
服务器收到syn包，必须确认客户的SYN（ack=x+1），同时自己也发送一个SYN包（Seq=y），即SYN+ACK包，此时服务器进入SYN_RECV状态；
##### 第三次握手：
客户端收到服务器的SYN＋ACK包，向服务器发送确认包ACK(ack=y+1)，此包发送完毕，客户端和服务器进入ESTABLISHED状态，完成三次握手。
握手过程中传送的包里不包含数据，三次握手完毕后，客户端与服务器才正式开始传送数据。理想状态下，TCP连接一旦建立，在通信双方中的任何一方主动关闭连接之前，TCP 连接都将被一直保持下去。


##### 四次挥手




#### 浏览器解析渲染页面

* 解析HTML形成DOM树
* 解析CSS形成CSSOM 树
* 合并DOM树和CSSOM树形成渲染树
* 执行javascript
* 浏览器开始渲染并绘制页面
* 布局 （layout) 根据渲染书将节点树的每一个节点布局在屏幕的正确位置
* 绘制 遍历渲染书绘制所有节点，为每一个节点使用对应的样式，这一过程是通过UI后端模块完成


#### 页面渲染优化





### 性能优化之回流重绘

#### 回流
当Render Tree中部分或全部元素的尺寸、结构、或某些属性发生改变时，浏览器重新渲染部分或全部文档的过程称为回流。

* 页面首次渲染
* 浏览器窗口大小发生改变
* 元素尺寸或位置发生改变
* 元素内容变化（文字数量或图片大小等等）
* 元素字体大小变化
* 添加或者删除可见的DOM元素
* 激活CSS伪类（例如：:hover）
* 查询某些属性或调用某些方法


#### 重绘

当页面中元素样式的改变并不影响它在文档流中的位置时（例如：color、background-color、visibility等），浏览器会将新样式赋予给元素并重新绘制它，这个过程称为重绘。














